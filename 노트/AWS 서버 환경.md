이번에 만든 프로젝트를 localhost:8080에서만 끝내지 않고, <br> 실제 URL 주소를 가지고 CI/CD 환경을 갖춘 서비스를 만들어 보려고 한다. <br>
스프링부트 프로젝트를 AWS 인프라에 배포해보자. <br> <br>
전체적인 시스템 구조는 다음과 같다. <br>
![springawsnote3](https://github.com/Kim-Gyuri/Improved-SpringBoot-Online-Shopping-Store/assets/57389368/854b53ac-2d9b-4249-8524-bb0b5356ad1b) <br>
하나의 EC2 혹은 리눅스 서버에 NginX 1대와 스프링 부트 Jar 2대를 사용하는 것이다. <br>
+ `1` 사용자는 서비스 주소로 접속한다. (80 혹은 443 포트)
+ `2` 엔진엑스가 필요한 배포에 따라 nginx reload 명령어를 통해 연결한다.

우선 아래 과정이 필요하다. <br>
+ `3` EC2 서버에 프로젝트를 배포한다. (EC2 생성, RDS 연동)
+ `4` Travis CI와 S3를 연동한다. (jar파일을 전달하기 위해 s3 연동이 먼저)
+ `5` 실제 배포는 AWS CodeDeploy 서비스를 이용한다.
+ `6` Travis CI 웹 서비스 설정 (깃허브 저장소 활성화)

### AWS
AWS라는 클라우드 서비스를 이용해 본격적으로 서버 배포를 해보자. <br> 
>  `클라우드 서비스` : <br> 쉽게 말하면 인터넷(클라우드)을 통해 서버, 스토리지(파일 저장소), 데이터베이스, 네트워크, 소프트웨어, 모니터링 등의 컴퓨팅 서비스를 제공하는 것이다. <br>
AWS EC2는 서버 장비를 대여하는 것이지만, 실제로는 그 안의 로그관리, 모니터링, 하드웨어 교체, 네트워크 관리 등을 지원한다.

AWS의 EC2, S3를 사용하는데 프리티어로 무중단 배포가 불가능하다. <br> 
> 돈을 내고 2대를 사용하면 가능하다. 

## AWS EC2 인스턴스 생성하기
> [참고자료](https://heytech.tistory.com/390)

EC2, AWS에서 "리눅스 서버를 사용한다."라고 하면 EC2를 말하는 것이다. <br><br>
EC2 인스턴스 생성과정은 다음과 같다. <br>
+ 인스턴스 유형 선택하기 :프리티어(t2.micro) 선택
+ 세부 정보 구성
> VPC, 서브넷 등 AWS 서비스들의 네트워크 환경을 설정한다. <br> `여기서는 혼자서 1대의 서버만 사용하니 별다른 설정 없이 넘긴다`

+ 스토리지 구성 :크기(30 GiB)
> 스토리지는 `하드디스크`라고 부르는 서버의 디스크(SSD도 포함)를 이야기하며 서버의 용량을 얼마나 정할지 선택하는 단계다. <br>
> 30GB까지 프리티어로 가능하다. <br>

+ 태그 추가 : 웹 콘솔에서 표기될 태그인 Name 태그를 등록한다. (EC2의 이름을 붙인다고 생각하자)
+ 보안 그룹 : SSH 접속을 내 IP로 선택한다.
  > 보안 그룹은 `방화벽`이다. `서버로 80포트 외에는 허용하지 않는다`는 역할을 하는 방화벽이 AWS에서는 보안 그룹으로 사용된다. <br>
  > 유형 항목에서 SSH이면서 포트 항목에서 22인 경우는 AWS EC2에 터미널로 접속할 때를 이야기한다. <br> 보안은 언제나 높을수록 좋으니 pem 키 관리와 `지정된 IP에서만 ssh 접속`이 가능하도록 구성하자.
  
+ 키 페서 생성
+ EIP 할당 <br>
  > 같은 인스턴스를 중지하고 `다시 시작할 때도 새 IP가 할당된다.` <br> 즉 요금을 아끼기 위해 잠깐 인스턴스를 중지하고 다시 시작하면 IP가 변경되는 것이다. <br> 이렇게 되면 매번 접속해야 하는 IP가 변경되어서 PC에서 접근할 떄마다 IP주소를 확인해야 한다. <br>
굉장히 번거로우므로 인스턴스의 IP가 `매번 변경되지 않고 고정IP를 가지게 해야 한다` <br> 고정 IP를 할당해야 한다. <br> 탄력적 IP는 `생성하고 EC2서버에 연결하지 않으면 비용이 발생한다`
  
## EC2 서버에 접속하기
Window경우 AWS와 같은 외부 서버로 SSH 접속하려면 아래과 같다. <br>
+ pem키를 가지고, puttygen.exe를 실행하여 ppk파일로 변환한다.
+ putty.exe를 실행하여 SSH 접속한다.
> 최신 버전에서는 Auth에서 private key, Certificate에 모두 키를 불러와야 한다. <br> [EC2 - ppk등록 참고자료](https://skyversion.tistory.com/18)
  
